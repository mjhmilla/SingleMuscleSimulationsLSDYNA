*KEYWORD
*MAT_156
$#     mid        ro       sno       srm       pis       ssm       cer       dmp
         1       1.0      &sno      &srm &fceOptAT 1.4380893       0.0       0.0
$#     alm       sfr       svs       svr       ssp
  -2899501       1.0       -10       -12       -11              
$
*DEFINE_CURVE
$#    lcid      sidr       sfa       sfo      offa      offo    dattyp
        10         0       1.0       1.0       0.0       0.0
$#                a1                  o1
   0.080807646049264   0.000091917085423
   0.094383346510582   0.000097860884374
   0.107269540718254   0.000102181941362
   0.119689140953258   0.000105442609612
   0.131774141572646   0.000107973467366
   0.143609039204158   0.000109982303708
   0.155251040975352   0.000111606305981
   0.166740556360996   0.000112939568699
   0.178107098050790   0.000114048644533
   0.189372810734350   0.000123406823506
   0.200554686665850   0.000172503588810
   0.211666013026894   0.000274007450511
   0.222717349181919   0.000443342193635
   0.233717205210475   0.000704632665854
   0.244672524458765   0.001100162087122
   0.255589033934380   0.001719118045181
   0.266471503427383   0.002841793973960
   0.277323940255876   0.011070612092692
   0.288149737754686   0.035779523434891
   0.298951789969553   0.073798984903258
   0.309732581290312   0.122685395308632
   0.320494257247107   0.180669371584932
   0.331238680973170   0.246418803684865
   0.341967478638204   0.318899743071000
   0.352682076307191   0.397289783695166
   0.363383730069725   0.477922625300695
   0.374073550841646   0.556214839386621
   0.384752524914423   0.631306293625107
   0.395421531085023   0.701779604786896
   0.406081355016553   0.764828584743915
   0.416732701341509   0.812868363970155
   0.427376203913551   0.832202971471256
   0.438012434531919   0.846614334182013
   0.448641910398989   0.860295277951102
   0.459265100521677   0.873597834702296
   0.469882431228039   0.886654911829409
   0.480494290939252   0.899534329032479
   0.491101034312198   0.912291062207194
   0.501702985847864   0.925017167667717
   0.512300443044576   0.937723166554923
   0.522893679161960   0.950405880988823
   0.533482945650794   0.963052065270473
   0.544068474295121   0.975039000655399
   0.554650479105758   0.985203801670368
   0.565229157998355   0.993149717675836
   0.575804694284153   0.998340645805874
   0.586377257997494   0.999682924387804
   0.596947007080617   0.988854063627554
   0.607514088443395   0.970556863795850
   0.618078638913178   0.948544582698846
   0.628640786087874   0.924192669085445
   0.639200649103588   0.898189798972592
   0.649758339326684   0.870939663801397
   0.660313960978828   0.842703166749639
   0.670867611702474   0.813660610735109
   0.681419383073354   0.783942857683863
   0.691969361065657   0.753852426859687
   0.702517626474960   0.723725915223901
   0.713064255303311   0.693575819769363
   0.723609319110370   0.663406453964150
   0.734152885334068   0.633220354222768
   0.744695017583813   0.603019287719260
   0.755235775908974   0.572804611584086
   0.765775217045027   0.542577432229592
   0.776313394639525   0.512338686995327
   0.786850359459778   0.482093601159755
   0.797386159583972   0.451859141636949
   0.807920840577235   0.421639624356634
   0.818454445654020   0.391438642873715
   0.828987015828046   0.361260528592858
   0.839518590050872   0.331110647035910
   0.850049205340122   0.300995856386874
   0.860578896898244   0.270925253820589
   0.871107698222601   0.240911468795704
   0.881635641207643   0.210973093599595
   0.892162756239803   0.181139784423871
   0.902689072285716   0.151464842881405
   0.913214616974316   0.122065737188735
   0.923739416673286   0.093360568990766
   0.934263496560318   0.070425299832855
   0.944786880689597   0.054044308441212
   0.955309592053853   0.041584012728646
   0.965831652642361   0.031809457714884
   0.976353083495159   0.024023553723444
   0.986873904753789   0.017787029150803
   0.997394135708814   0.012801903819763
   1.007913794844344   0.008855026890688
   1.018432899879800   0.005787684557627
   1.028951467809092   0.003477920800777
   1.039469514937425   0.001829619214736
   1.049987056915875   0.000765431080724
   1.060504108773904   0.000222012897527
   1.071020684949950   0.000122687483257
   1.081536799320227   0.000122690606110
   1.092052465225860   0.000122693576590
   1.102567695498453   0.000122696400470
   1.113082502484212   0.000122699083249
   1.123596898066703   0.000122701630174
   1.134110893688344   0.000122704046247
   1.144624500370705   0.000122706336245
   1.155137728733701   0.000122708504726
$
*DEFINE_CURVE
$#    lcid      sidr       sfa       sfo      offa      offo    dattyp
        11         0       1.0       1.0       0.0       0.0
$#                a1                  o1
   0.457719043922718   0.000121495705752
   0.461425871368740   0.000121519802246
   0.465131995277659   0.000121543351917
   0.468837432333694   0.000121566371754
   0.472542198694706   0.000121588878091
   0.476246310012900   0.000121610886637
   0.479949781454561   0.000121632412501
   0.483652627718860   0.000121653470226
   0.487354863055799   0.000121674073806
   0.491056501283319   0.000135966163197
   0.494757555803642   0.000211902528842
   0.498458039618856   0.000355217481786
   0.502157965345820   0.000568239634889
   0.505857345230386   0.000853431532257
   0.509556191161010   0.001213400905376
   0.513254514681748   0.001650913161491
   0.516952327004705   0.002168905274178
   0.520649639021926   0.002770501274463
   0.524346461316795   0.003459029574778
   0.528042804174935   0.004238042398911
   0.531738677594656   0.005111337640492
   0.535434091296957   0.006082983532566
   0.539129054735120   0.007157346584040
   0.542823577103896   0.008339123328778
   0.546517667348326   0.009633376544126
   0.550211334172191   0.011045576733746
   0.553904586046126   0.012581649842157
   0.557597431215405   0.014248032385798
   0.561289877707416   0.016051735461123
   0.564981933338842   0.018000419442806
   0.568673605722549   0.020102481639682
   0.572364902274218   0.022367159767378
   0.576055830218709   0.024804654873407
   0.579746396596181   0.027426278381434
   0.583436608267983   0.030244629305274
   0.587126471922311   0.033273809563199
   0.590815994079657   0.036529687911359
   0.594505181098051   0.040030226629804
   0.598194039178108   0.043795890223243
   0.601882574367887   0.047850162802548
   0.605570792567565   0.052220211708926
   0.609258699533954   0.056937751323178
   0.612946300884833   0.062040186224216
   0.616633602103142   0.067572152755522
   0.620320608541013   0.073587643122687
   0.624007325423661   0.080153006050289
   0.627693757853134   0.087351311388508
   0.631379910811935   0.095288922918523
   0.635065789166513   0.104105820894699
   0.638751397670632   0.113992676370407
   0.642436740968623   0.125221015552110
   0.646121823598527   0.138032600094173
   0.649806649995125   0.152186618923518
   0.653491224492868   0.167411976710403
   0.657175551328708   0.183518272005432
   0.660859634644826   0.200365701859952
   0.664543478491285   0.217848022687083
   0.668227086828572   0.235882247324060
   0.671910463530078   0.254402083937899
   0.675593612384478   0.273353578820775
   0.679276537098047   0.292692120634434
   0.682959241296887   0.312380319686708
   0.686641728529097   0.332386468765228
   0.690324002266858   0.352683401734642
   0.694006065908462   0.373247631042773
   0.697687922780270   0.394058685102568
   0.701369576138612   0.415098591694052
   0.705051029171623   0.436351469883293
   0.708732285001026   0.457803203833397
   0.712413346683851   0.479441179274618
   0.716094217214114   0.501254068521267
   0.719774899524432   0.523231653532317
   0.723455396487591   0.545364679096843
   0.727135710918072   0.567644730102725
   0.730815845573522   0.590064128228801
   0.734495803156189   0.612615844430122
   0.738175586314306   0.635293424361604
   0.741855197643437   0.658090924475904
   0.745534639687787   0.681002856985159
   0.749213914941462   0.704024142228354
   0.752893025849708   0.727150067261344
   0.756571974810093   0.750376249703649
   0.760250764173678   0.773698606048458
   0.763929396246131   0.797113323780092
   0.767607873288827   0.820616836754121
   0.771286197519906   0.844205803385088
   0.774964371115301   0.867877087260006
   0.778642396209745   0.891627739855658
   0.782320274897738   0.915454985087064
   0.785998009234497   0.939356205455297
   0.789675601236871   0.963328929596711
   0.793353052884235   0.987370821063983
   0.797030366119358   1.011476110974070
   0.800707542849248   1.035597053318611
   0.804384584945972   1.059719239675599
   0.808061494247453   1.083842643622864
   0.811738272558249   1.107967239385827
   0.815414921650306   1.132093001819141
   0.819091443263694   1.156219906388911
   0.822767839107318   1.180347929155504
   0.826444110859623   1.204477046756898
$
*DEFINE_CURVE
$#    lcid      sidr       sfa       sfo      offa      offo    dattyp
        12         0       1.0       1.0       0.0       0.0
$#                a1                  o1
  -0.648923053628380   0.000122056884766
  -0.641206130828475   0.000122058496094
  -0.633489208028570   0.000122060107422
  -0.625772285228665   0.000122061718750
  -0.618055362428760   0.000122063330078
  -0.610338439628855   0.000122064941406
  -0.602621516828950   0.000122066552734
  -0.594904594029044   0.000122068164063
  -0.587187671229140   0.000122069775391
  -0.579470748429234   0.000339669226664
  -0.571753825629329   0.001201073085136
  -0.564036902829424   0.002437577926703
  -0.556319980029519   0.003914349742284
  -0.548603057229614   0.005562017603801
  -0.540886134429709   0.007339294487011
  -0.533169211629804   0.009219245835846
  -0.525452288829899   0.011183189807857
  -0.517735366029994   0.013216447261137
  -0.510018443230089   0.015293460672677
  -0.502301520430184   0.017398407462537
  -0.494584597630279   0.019523184390602
  -0.486867674830374   0.021662981807344
  -0.479150752030469   0.023814667717520
  -0.471433829230564   0.025976067505535
  -0.463716906430658   0.028151688049616
  -0.455999983630754   0.030375980086870
  -0.448283060830848   0.032656472043331
  -0.440566138030943   0.034995590000858
  -0.432849215231038   0.037395939784991
  -0.425132292431133   0.039860326180182
  -0.417415369631228   0.042391774869639
  -0.409698446831323   0.044993557587439
  -0.401981524031418   0.047669221077111
  -0.394264601231513   0.050422620585421
  -0.386547678431608   0.053257958790868
  -0.378830755631703   0.056179831285224
  -0.371113832831798   0.059193280009011
  -0.363396910031893   0.062303856410141
  -0.355679987231988   0.065517696579743
  -0.347963064432083   0.068841611264052
  -0.340246141632178   0.072283194518837
  -0.332529218832272   0.075850955954589
  -0.324812296032367   0.079554483152116
  -0.317095373232462   0.083404643113608
  -0.309378450432557   0.087413834867761
  -0.301661527632652   0.091596310061854
  -0.293944604832747   0.095968585339999
  -0.286227682032842   0.100549980827791
  -0.278510759232937   0.105363335326740
  -0.270793836433032   0.110435974728282
  -0.263076913633127   0.115801052690139
  -0.255359990833222   0.121499455017003
  -0.247643068033317   0.127582587710276
  -0.239926145233412   0.134116608379023
  -0.232209222433507   0.141186835075739
  -0.224492299633602   0.148815310084035
  -0.216775376833697   0.157006923852986
  -0.209058454033792   0.165790228369628
  -0.201341531233887   0.175196273123041
  -0.193624608433981   0.185258922092035
  -0.185907685634076   0.196015224416460
  -0.178190762834171   0.207505850300874
  -0.170473840034266   0.219775606755594
  -0.162756917234361   0.232874051809538
  -0.155039994434456   0.246856231198541
  -0.147323071634551   0.261783568770483
  -0.139606148834646   0.277724951727556
  -0.131889226034741   0.294758065495058
  -0.124172303234836   0.312971052202536
  -0.116455380434931   0.332464594165591
  -0.108738457635026   0.353354563583002
  -0.101021534835121   0.375775438711946
  -0.093304612035216   0.399884776298134
  -0.085587689235311   0.425869169161057
  -0.077870766435406   0.453952340239887
  -0.070153843635501   0.484406391552138
  -0.062436920835595   0.517567855435566
  -0.054719998035690   0.553861320198086
  -0.047003075235785   0.593835518804720
  -0.039286152435880   0.638221003023111
  -0.031569229635975   0.688027654426320
  -0.023852306836070   0.744721921791790
  -0.016135384036165   0.810581732328924
  -0.008418461236260   0.889511957404754
  -0.000701538436355   0.989367200993411
   0.007015384363550   1.157266308940131
   0.014732307163455   1.197722570284723
   0.022449229963360   1.214947301526917
   0.030166152763265   1.222149189426940
   0.037883075563170   1.225472931172871
   0.045599998363075   1.228695259741327
   0.053316921162980   1.231884632021613
   0.061033843962885   1.235056000000000
   0.068750766762791   1.238224000000000
   0.076467689562696   1.241392000000000
   0.084184612362601   1.244560000000000
   0.091901535162506   1.247728000000000
   0.099618457962411   1.250896000000000
   0.107335380762316   1.254064000000000
   0.115052303562221   1.257232000000000
   0.122769226362126   1.260400000000000
   0.584615363629171   1.439191919879918
$         
$--------------------------------------------------------------------------------
$ Activation dynamics code (below) comes from the OpenHBM model and specifically
$ the code of Putra et al. that is released as part of the OpenHBM project under
$ the lgpl3 license.
$  
$ Putra, I P A, Iraeus J, Thomson R, Svensson M Y, Linder A, Sato F. 2019.
$ Comparison of control strategies for the cervical muscles of an average female 
$ head-neck finite element model. Traffic Injury Prevention
$ https://doi.org/10.1080/15389588.2019.1670818
$
$--------------------------------------------------------------------------------
*DEFINE_FUNCTION_TABULATED
28000015
stimFcn
$#                a1                  o1
                 0.0                 0.0
             &timeS0                 0.0
             &timeS1             &actVal
              &timeE             &actVal
$--------------------------------------------------------------------------------
$ 6.2.1.1 activation dynamics filter
$--------------------------------------------------------------------------------
$
*DEFINE_FUNCTION
28990210,1ode Ne/Na filter
float ode28990210(float u,float tne,float tna1,float tna2, float tt)
{
float na,ne,t,tts,dt;
dt=tt-tts;
tts=tt;
ne=ne+dt*(u-ne)/tne;
t=tna1;
if(ne<na) t=tna2;
na=na+dt*(ne-na)/t;
return na;
}
$--------------------------------------------------------------------------------
$ Filtered signal (from the viva 50f model)
$--------------------------------------------------------------------------------
$
*DEFINE_CURVE_FUNCTION
28990310
ode28990210(stimFcn(TIME),0.035,0.010,0.040,TIME)
$--------------------------------------------------------------------------------
$ 6.2.1.3 activation signal going to muscle activation
$--------------------------------------------------------------------------------
$
*DEFINE_CURVE_FUNCTION
2899501
MIN(MAX(LC28990310,0.0),1.0)   
*END
