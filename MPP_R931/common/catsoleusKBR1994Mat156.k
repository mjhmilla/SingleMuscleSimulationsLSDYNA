*KEYWORD
*MAT_156
$#     mid        ro       sno       srm       pis       ssm       cer       dmp
         1       1.0      &sno      &srm &fceOptAT      &sno       0.0       0.0
$#     alm       sfr       svs       svr       ssp
  -2899501       1.0       -10       -12       -11              
$
*DEFINE_CURVE
$#    lcid      sidr       sfa       sfo      offa      offo    dattyp
        10         0       1.0       1.0       0.0       0.0
$#                a1                  o1
   0.138223610046145   0.000091917085423
   0.161445203774102   0.000097860884374
   0.183487378867957   0.000102181941362
   0.204731432664124   0.000105442609612
   0.225403144991981   0.000107973467366
   0.245647049562063   0.000109982303708
   0.265561000675018   0.000111606305981
   0.285214119803327   0.000112939568699
   0.304656889181183   0.000114048644533
   0.323927187884291   0.000123406823506
   0.343054081611622   0.000172503588810
   0.362060298437789   0.000274007450511
   0.380963900434186   0.000443342193635
   0.399779444316358   0.000704632665854
   0.418518806861128   0.001100162087122
   0.437191784266046   0.001719118045181
   0.455806535382825   0.002841793973960
   0.474369914834783   0.011070612092692
   0.492887727010649   0.035779523434891
   0.511364922251995   0.073798984903258
   0.529805750173168   0.122685395308632
   0.548213880760070   0.180669371584932
   0.566592500951239   0.246418803684865
   0.584944392352847   0.318899743071000
   0.603271994286660   0.397289783695165
   0.621577455327062   0.477922625300695
   0.639862675724899   0.556214839386621
   0.658129342557744   0.631306293625107
   0.676378959030992   0.701779604786896
   0.694612869042108   0.764828584743915
   0.712832277883562   0.812868363970155
   0.731038269778762   0.832202971471256
   0.749231822805388   0.846614334182013
   0.767413821651750   0.860295277951102
   0.785585068566543   0.873597834702296
   0.803746292795157   0.886654911829409
   0.821898158742258   0.899534329032479
   0.840041273057801   0.912291062207194
   0.858176190809281   0.925017167667717
   0.876303420875430   0.937723166554923
   0.894423430674050   0.950405880988823
   0.912536650318326   0.963052065270473
   0.930643476280979   0.975039000655399
   0.948744274633159   0.985203801670368
   0.966839383914801   0.993149717675836
   0.984929117684621   0.998340645805874
   1.003013766790844   0.999682924387804
   1.021093601397839   0.988854063627554
   1.039168872798815   0.970556863795850
   1.057239815040567   0.948544582698847
   1.075306646382678   0.924192669085445
   1.093369570610602   0.898189798972592
   1.111428778219442   0.870939663801397
   1.129484447483103   0.842703166749638
   1.147536745421583   0.813660610735109
   1.165585828677583   0.783942857683863
   1.183631844312224   0.753852426859687
   1.201674930528470   0.723725915223901
   1.219715217329828   0.693575819769363
   1.237752827120987   0.663406453964150
   1.255787875256304   0.633220354222768
   1.273820470541351   0.603019287719260
   1.291850715692155   0.572804611584086
   1.309878707756247   0.542577432229592
   1.327904538499180   0.512338686995327
   1.345928294759779   0.482093601159755
   1.363950058777046   0.451859141636949
   1.381969908491336   0.421639624356634
   1.399987917822112   0.391438642873715
   1.418004156924420   0.361260528592858
   1.436018692425930   0.331110647035910
   1.454031587646265   0.300995856386874
   1.472042902800139   0.270925253820589
   1.490052695185677   0.240911468795704
   1.508061019359177   0.210973093599595
   1.526067927297431   0.181139784423871
   1.544073468548636   0.151464842881405
   1.562077690372811   0.122065737188735
   1.580080637872572   0.093360568990766
   1.598082354115028   0.070425299832855
   1.616082880245493   0.054044308441212
   1.634082255593642   0.041584012728646
   1.652080517772708   0.031809457714884
   1.670077702772232   0.024023553723444
   1.688073845044852   0.017787029150803
   1.706068977587584   0.012801903819763
   1.724063132017990   0.008855026890688
   1.742056338645600   0.005787684557627
   1.760048626538951   0.003477920800777
   1.778040023588524   0.001829619214736
   1.796030556565899   0.000765431080724
   1.814020251179365   0.000222012897527
   1.832009132126250   0.000122687483257
   1.849997223142188   0.000122690606110
   1.867984547047522   0.000122693576590
   1.885971125791052   0.000122696400470
   1.903956980491287   0.000122699083249
   1.921942131475380   0.000122701630174
   1.939926598315889   0.000122704046247
   1.957910399865500   0.000122706336245
   1.975893554289859   0.000122708504726
$
*DEFINE_CURVE
$#    lcid      sidr       sfa       sfo      offa      offo    dattyp
        11         0       1.0       1.0       0.0       0.0
$#                a1                  o1
   0.765386139017132   0.000123992599626
   0.771730252324554   0.000124018847165
   0.778073078222525   0.000124044484538
   0.784414647941265   0.000124069531125
   0.790754991703088   0.000124094005539
   0.797094138762964   0.000124117925666
   0.803432117447130   0.000124141308697
   0.809768955189857   0.000124164171158
   0.816104678568477   0.000124186528947
   0.822439313336752   0.000138775176874
   0.828772884456705   0.000216282539065
   0.835105416128966   0.000362563343962
   0.841436931821731   0.000579996273275
   0.847767454298401   0.000871096688506
   0.854097005643974   0.001238528126709
   0.860425607290253   0.001685115054091
   0.866753280039936   0.002213857051015
   0.873080044089637   0.002827944630910
   0.879405919051904   0.003530776930259
   0.885730923976280   0.004325981548569
   0.892055077369448   0.005217436867637
   0.898378397214525   0.006209297240669
   0.904700900989522   0.007306021516644
   0.911022605685037   0.008512405457084
   0.917343527821200   0.009833618715856
   0.923663683463912   0.011275247193477
   0.929983088240419   0.012843341753657
   0.936301757354242   0.014544474511700
   0.942619705599497   0.016385804185888
   0.948936947374646   0.018375152362932
   0.955253496695683   0.020521092992616
   0.961569367208801   0.022833058030517
   0.967884572202557   0.025321462940739
   0.974199124619556   0.027997856823160
   0.980513037067676   0.030875103342491
   0.986826321830865   0.033967600555918
   0.993138990879514   0.037291550378446
   0.999451055880433   0.040865292115545
   1.005762528206451   0.044709719728713
   1.012073418945652   0.048848810058568
   1.018383738910258   0.053310300354137
   1.024693498645190   0.058126570180677
   1.031002708436303   0.063335808528241
   1.037311378318320   0.068983587673293
   1.043619518082477   0.075125031772678
   1.049927137283887   0.081827880375966
   1.056234245248638   0.089176944453469
   1.062540851080641   0.097280816868578
   1.068846963668219   0.106282411112860
   1.075152591690481   0.116376393212485
   1.081457743623455   0.127839977765881
   1.087762427746012   0.140919995547633
   1.094066652145586   0.155370611145441
   1.100370424723688   0.170915067335808
   1.106673753201239   0.187358985513996
   1.112976645123711   0.204559641884231
   1.119279107866100   0.222408572555588
   1.125581148637727   0.240821055506460
   1.131882774486874   0.259729412524585
   1.138183992305273   0.279078561051930
   1.144484808832439   0.298822955902167
   1.150785230659860   0.318924424277272
   1.157085264235050   0.339350594480853
   1.163384915865473   0.360073730697336
   1.169684191722330   0.381069852501197
   1.175983097844231   0.402318058413286
   1.182281640140748   0.423799998524270
   1.188579824395849   0.445499457899465
   1.194877656271229   0.467402023584356
   1.201175141309530   0.489494815576543
   1.207472284937466   0.511766267357270
   1.213769092468838   0.534205945260294
   1.220065569107470   0.556804398593987
   1.226361719950045   0.579553034349053
   1.232657549988851   0.602444011734839
   1.238953064114453   0.625470152838136
   1.245248267118269   0.648624866490249
   1.251543163695084   0.671902083030897
   1.257837758445475   0.695296198120855
   1.264132055878167   0.718802024114665
   1.270426060412323   0.742414747785791
   1.276719776379756   0.766129893418175
   1.283013208027090   0.789943290454096
   1.289306359517838   0.813851045028897
   1.295599234934440   0.837849514836417
   1.301891838280222   0.861935286860610
   1.308184173481317   0.886105157583521
   1.314476244388511   0.910356115340966
   1.320768054779052   0.934685324547587
   1.327059608358398   0.959090111554622
   1.333350908761920   0.983567951938337
   1.339641959556551   1.008116459045984
   1.345932764242398   1.032729741685307
   1.352223326254299   1.057359049432549
   1.358513648963338   1.081989669810486
   1.364803735678326   1.106621574563575
   1.371093589647232   1.131254736137819
   1.377383214058579   1.155889127660615
   1.383672612042797   1.180524722921261
   1.389961786673547   1.205161496352103
   1.396250740969003   1.229799423010299
$
*DEFINE_CURVE
$#    lcid      sidr       sfa       sfo      offa      offo    dattyp
        12         0       1.0       1.0       0.0       0.0
$#                a1                  o1
  -1.100000000000000   0.000122058105469
  -1.078000000000000   0.000122060791016
  -1.056000000000000   0.000122063476563
  -1.034000000000000   0.000122066162109
  -1.012000000000000   0.000122068847656
  -0.990000000000000   0.000396295251607
  -0.968000000000000   0.002112180399370
  -0.946000000000000   0.004595317347952
  -0.924000000000000   0.007506284413780
  -0.902000000000000   0.010700139890683
  -0.880000000000000   0.014093445799037
  -0.858000000000000   0.017590838541393
  -0.836000000000000   0.021143051952854
  -0.814000000000000   0.024730541361328
  -0.792000000000000   0.028351634722962
  -0.770000000000000   0.032098337169462
  -0.748000000000000   0.036006284094080
  -0.726000000000000   0.040087639393475
  -0.704000000000000   0.044356177874410
  -0.682000000000000   0.048827600758169
  -0.660000000000000   0.053519935379384
  -0.638000000000000   0.058454048285515
  -0.616000000000000   0.063654313729860
  -0.594000000000000   0.069149499267872
  -0.572000000000000   0.074973961405726
  -0.550000000000000   0.081169295294819
  -0.528000000000000   0.087786668877664
  -0.506000000000000   0.094890224306719
  -0.484000000000000   0.102562211596075
  -0.462000000000000   0.110911072754440
  -0.440000000000000   0.120084858716334
  -0.418000000000000   0.130295035485371
  -0.396000000000000   0.141857769828020
  -0.374000000000000   0.154967870057703
  -0.352000000000000   0.169702720728227
  -0.330000000000000   0.186207520662645
  -0.308000000000000   0.204650476915138
  -0.286000000000000   0.225228257552242
  -0.264000000000000   0.248173227768469
  -0.242000000000000   0.273763238641358
  -0.220000000000000   0.302335163800238
  -0.198000000000000   0.334304103060830
  -0.176000000000000   0.370191454228016
  -0.154000000000000   0.410667439845578
  -0.132000000000000   0.456618382897579
  -0.110000000000000   0.509259004794259
  -0.088000000000000   0.570333166476467
  -0.066000000000000   0.642506816512914
  -0.044000000000000   0.730241413257785
  -0.022000000000000   0.842150343552352
   0.000000000000000   1.000000000000000
   0.022000000000000   1.191047147412257
   0.044000000000000   1.218913123543933
   0.066000000000000   1.225767993619052
   0.088000000000000   1.231113510738884
   0.110000000000000   1.236400000000000
   0.132000000000000   1.241680000000000
   0.154000000000000   1.246960000000000
   0.176000000000000   1.252240000000000
   0.198000000000000   1.257520000000000
   0.220000000000000   1.262800000000000
   0.242000000000000   1.268080000000000
   0.264000000000000   1.273360000000000
   0.286000000000000   1.278640000000000
   0.308000000000000   1.283920000000000
   0.330000000000000   1.289200000000000
   0.352000000000000   1.294480000000000
   0.374000000000000   1.299760000000000
   0.396000000000000   1.305040000000000
   0.418000000000000   1.310320000000000
   0.440000000000000   1.315600000000000
   0.462000000000000   1.320880000000000
   0.484000000000000   1.326160000000001
   0.506000000000000   1.331440000000001
   0.528000000000000   1.336720000000000
   0.550000000000000   1.342000000000001
   0.572000000000000   1.347280000000000
   0.594000000000000   1.352560000000000
   0.616000000000000   1.357840000000001
   0.638000000000000   1.363120000000001
   0.660000000000000   1.368400000000001
   0.682000000000000   1.373680000000001
   0.704000000000000   1.378960000000001
   0.726000000000000   1.384240000000001
   0.748000000000000   1.389520000000001
   0.770000000000000   1.394800000000001
   0.792000000000000   1.400080000000001
   0.814000000000000   1.405360000000001
   0.836000000000000   1.410640000000001
   0.858000000000000   1.415920000000001
   0.880000000000000   1.421200000000001
   0.902000000000000   1.426480000000001
   0.924000000000000   1.431760000000001
   0.946000000000000   1.437040000000001
   0.968000000000000   1.442320000000001
   0.990000000000000   1.447600000000001
   1.012000000000000   1.452880000000001
   1.034000000000000   1.458160000000001
   1.056000000000000   1.463440000000001
   1.078000000000000   1.468720000000001
   1.100000000000000   1.474000000000001
$
$--------------------------------------------------------------------------------
$ Activation dynamics code (below) comes from the OpenHBM model and specifically
$ the code of Putra et al. that is released as part of the OpenHBM project under
$ the lgpl3 license.
$  
$ Putra, I P A, Iraeus J, Thomson R, Svensson M Y, Linder A, Sato F. 2019.
$ Comparison of control strategies for the cervical muscles of an average female 
$ head-neck finite element model. Traffic Injury Prevention
$ https://doi.org/10.1080/15389588.2019.1670818
$
$--------------------------------------------------------------------------------
*DEFINE_FUNCTION_TABULATED
28000015
stimFcn
$#                a1                  o1  
                 0.0            &stimLow
          &stimTimeA            &stimLow                 
          &stimTimeS           &stimHigh
          &stimTimeE           &stimHigh
          &stimTimeB            &stimLow          
              &timeE            &stimLow
$--------------------------------------------------------------------------------
$ 6.2.1.1 activation dynamics filter
$--------------------------------------------------------------------------------
$
*DEFINE_FUNCTION
28990210,1ode Ne/Na filter
float ode28990210(float u,float tne,float tna1,float tna2, float tt)
{
float na,ne,t,tts,dt;
dt=tt-tts;
tts=tt;
ne=ne+dt*(u-ne)/tne;
t=tna1;
if(ne<na) t=tna2;
na=na+dt*(ne-na)/t;
return na;
}
$--------------------------------------------------------------------------------
$ Filtered signal (from the viva 50f model)
$--------------------------------------------------------------------------------
$
*DEFINE_CURVE_FUNCTION
28990310
ode28990210(stimFcn(TIME),0.040,0.040,0.080,TIME)
$--------------------------------------------------------------------------------
$ 6.2.1.3 activation signal going to muscle activation
$--------------------------------------------------------------------------------
$
*DEFINE_CURVE_FUNCTION
2899501
MIN(MAX(LC28990310,0.0),1.0)   
*END
